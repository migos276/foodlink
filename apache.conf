<VirtualHost *:8080>
    ServerName  foodlink237.org
    ServerAlias www.foodlink237.org

    # Proxy pour Next.js (frontend)
    ProxyPass / http://localhost:3000/
    ProxyPassReverse / http://localhost:3000/

    # Proxy pour Django API
    ProxyPass /api http://localhost:8000/api
    ProxyPassReverse /api http://localhost:8000/api

    # Configuration pour les WebSockets si nécessaire
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://localhost:8000/$1 [P,L]

    # Logs
    ErrorLog ${APACHE_LOG_DIR}/camer_eat_error.log
    CustomLog ${APACHE_LOG_DIR}/camer_eat_access.log combined

    # Sécurité
    <Directory />
        Options FollowSymLinks
        AllowOverride None
        Require all denied
    </Directory>

    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

# Configuration SSL (optionnel mais recommandé pour la production)
<VirtualHost *:443>
    ServerName foodlink237.org
    ServerAlias www.foodlink237.org

    SSLEngine on
    SSLCertificateFile /path/to/your/certificate.crt
    SSLCertificateKeyFile /path/to/your/private.key

    # Même configuration proxy que ci-dessus
    ProxyPass / http://localhost:3000/
    ProxyPassReverse / http://localhost:3000/

    ProxyPass /api http://localhost:8000/api
    ProxyPassReverse /api http://localhost:8000/api

    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://localhost:8000/$1 [P,L]

    ErrorLog ${APACHE_LOG_DIR}/camer_eat_ssl_error.log
    CustomLog ${APACHE_LOG_DIR}/camer_eat_ssl_access.log combined
</VirtualHost>
